const __vite__fileDeps=["assets/js/announceDialog-CphCUhHV.js","assets/js/base-BF0NbTgc.js","assets/js/index-CORk_IcO.js","assets/css/index-DVeDxo4X.css","assets/js/request-B6lB4qve.js","assets/css/base-7eBrKhXm.css","assets/js/el-overlay-DQWFqpwd.js","assets/js/vnode-DAecdaOi.js","assets/js/focus-trap-iw2TfUjY.js","assets/js/scroll-yH3ktnG-.js","assets/css/el-overlay-kecf_T5m.css","assets/js/user-D69gbmA6.js","assets/js/getFileListForm-D2k8zrnm.js","assets/js/el-loading-CSxoc70Y.js","assets/css/el-loading-D5XuAxUM.css","assets/js/el-card-FKQs21ip.js","assets/css/el-card-BRs6t4Sx.css","assets/js/el-form-item-Dqyuktbv.js","assets/js/use-form-item-B3RS_xJ7.js","assets/js/_initCloneObject-Bc0Ud9-G.js","assets/css/el-form-item-DeFBUyhQ.css","assets/js/el-button-7FNSxtug.js","assets/css/el-button-BWsECEeL.css","assets/js/el-input-B8i9DgR3.js","assets/css/el-input-CxR3fIHd.css","assets/js/copy-C1QAVJqY.js","assets/css/getFileListForm-CGNjtr_4.css","assets/js/showFileList-DToEy1X3.js","assets/js/el-table-column-CUpOV9MK.js","assets/js/el-popper-C8uzhFNb.js","assets/css/el-popper-DjkilKcQ.css","assets/css/el-table-column-BYuIAiBo.css","assets/js/el-space-BkjSR-qQ.js","assets/css/el-space-keklZC0K.css","assets/js/downloadDialog-6fXAt8RI.js","assets/js/el-text-5f85s--j.js","assets/css/el-text-CjuDOozN.css","assets/css/downloadDialog-KCNjwq80.css","assets/js/aria2ConfigDialog-R4N6rKMu.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as V,r as t,l as T,s as D,a as j,o as I,c as U,b as f,u as g,F as x,e as G,f as v,_}from"./index-CORk_IcO.js";import{d as M,a as N,b as z,c as B}from"./user-D69gbmA6.js";import{E as r}from"./request-B6lB4qve.js";const q=V("UserPannel",()=>{const d=t({announce:"",announceSwitch:!1,debug:!1,haveAccount:!1,havePassword:!1,haveLogin:!1,userAgent:"",ishttps:document.location.protocol==="https:",pending:!1}),m=async()=>{d.value.pending=!0;const e=await M()??"failed";d.value.pending=!1,e.toString()!=="failed"&&(Object.assign(d.value,{...e.data,announce:e.data.announce.replace(/\[NextLine\]/g,"<br>")}),D(e.data.haveLogin?"1":"0"))},a=t({url:"",pwd:"",password:"",dir:"/",bd_user_id:null,pending:!1}),p=t(null),l=t([]),o=t({randsk:"",shareid:0,uk:0,sign:"",timestamp:0}),u=t([]),w=t(null),F=async(e,s)=>{a.value.dir=e,await h(s)},k=()=>{const e=a.value.dir.split("/");e.pop();const s=e.join("/");return s===""?"/":s},h=async(e="0",s=!1)=>{const i=await N({url:a.value.url,pwd:a.value.pwd,dir:a.value.dir,password:a.value.password})??"failed";if(i.toString()==="failed")return;const{message:c,data:n}=i;return r.success(c),Object.assign(o.value,{randsk:n.randsk,shareid:n.shareid,uk:n.uk}),l.value=n.list,a.value.dir!==null&&a.value.dir!==""&&a.value.dir!=="/"?l.value=[{isdir:"1",path:k(),server_filename:"..",size:"0",server_mtime:s?l.value[0].server_mtime:e},...n.list]:l.value=n.list,"success"},L=async()=>{const e=await z({uk:o.value.uk,shareid:o.value.shareid,password:a.value.password})??"failed";if(e.toString()==="failed")return;const{message:s,data:i}=e;r.success(s),Object.assign(o.value,i)},b=async e=>{const s=await B({fs_ids:Array.isArray(e)?e:[e],...o.value,password:a.value.password,bd_user_id:a.value.bd_user_id}).catch(async c=>{const{message:n}=c;n.includes("当前签名已过期")?(r.error(n),r.info("自动重新获取中..."),await P(p.value)):n.includes("您没有权限指定下载的用户")&&(D("0"),r.error("登陆已过期,请重新登陆"),location.reload())})??"failed";if(!s||s==="failed")return;const{data:i}=s;r.success("解析成功"),y.value=i,S.value=!0},P=async e=>{e&&await e.validate(()=>{})&&(a.value.pending=!0,await h("0",!0),await L(),a.value.pending=!1)},E=async()=>{a.value.pending=!0;let e=!1;if(u.value=u.value.filter(i=>{var n;if(e)return!1;const c=i.isdir=="1";return c&&(e=!0,r.error("暂不支持下载文件夹"),(n=w.value)==null||n.clearSelection()),!c}),e){a.value.pending=!1;return}const s=u.value.map(i=>i.fs_id);await b(s),a.value.pending=!1},y=t([]),S=t(!1),O=t([]),A=t(!1),C=t(T()),R=t(null);return{getConfig:m,getDir:F,getFileList:h,getFileSign:L,freshFileList:P,downloadFile:b,downloadFiles:E,clientConfig:d,getFileListForm:a,getFileListFormRef:p,filelist:l,requestParams:o,selectedRows:u,fileListTableRef:w,dlinkList:y,downloadDialogVisible:S,selectDownloadFiles:O,aria2ConfigForm:C,aria2ConfigDialogVisible:A,aria2ConfigFormRef:R,saveAria2Config:async e=>{e&&await e.validate(()=>{})&&(localStorage.setItem("aria2_config",JSON.stringify(C.value)),r.success("保存成功"),A.value=!1)}}}),J=j({__name:"UserPannel",setup(d){const m=v(()=>_(()=>import("./announceDialog-CphCUhHV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),a=v(()=>_(()=>import("./getFileListForm-D2k8zrnm.js"),__vite__mapDeps([12,1,2,3,4,5,13,14,15,16,17,18,19,20,21,22,23,24,25,11,26]))),p=v(()=>_(()=>import("./showFileList-DToEy1X3.js"),__vite__mapDeps([27,1,2,3,4,5,13,14,15,16,28,29,19,8,18,30,31,32,7,33,11]))),l=v(()=>_(()=>import("./downloadDialog-6fXAt8RI.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,28,29,19,18,30,31,32,33,21,22,35,36,25,11,37]))),o=v(()=>_(()=>import("./aria2ConfigDialog-R4N6rKMu.js"),__vite__mapDeps([38,1,2,3,4,5,6,7,8,9,10,17,18,19,20,21,22,23,24,11]))),u=q();return I(u.getConfig),(w,F)=>(G(),U(x,null,[f(g(m)),f(g(a)),f(g(p)),f(g(l)),f(g(o))],64))}}),X=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{X as U,q as u};
