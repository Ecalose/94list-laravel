import"./base-e8db4a9d.js";import{E as N}from"./el-overlay-7435f68f.js";import{E as z,a as R}from"./el-table-column-c8343445.js";import"./el-popper-1e28a2d2.js";import{E as j}from"./el-space-84ca9b08.js";import{E as I}from"./el-button-21ff238e.js";import{E as M}from"./el-text-cb611d59.js";import{a as w,g as q,e as _,c as $,R as v,w as t,a5 as K,u as a,i as b,n as D,h as A,m as x,b as o,q as p,z as G,a1 as H,A as J}from"./index-607dfe2f.js";import{u as O}from"./UserPannel-4ccbd3e6.js";import{c as S}from"./copy-750d202c.js";import{b as Q,t as W,u as X,f as Y,_ as Z,w as ee,i as oe,E as g}from"./request-70b65b72.js";import"./vnode-cd43b426.js";import"./focus-trap-9634570e.js";import"./isNil-c75b1b34.js";import"./scroll-f050c522.js";import"./index-53bf12df.js";import"./_commonjsHelpers-725317a4.js";import"./_initCloneObject-b85b73ba.js";import"./use-form-item-1a794399.js";import"./user-b53389df.js";const te=Q({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},icon:{type:W}}),ae={click:r=>r instanceof MouseEvent},le=["href"],ne=w({name:"ElLink"}),se=w({...ne,props:te,emits:ae,setup(r,{emit:d}){const l=r,n=X("link"),u=q(()=>[n.b(),n.m(l.type),n.is("disabled",l.disabled),n.is("underline",l.underline&&!l.disabled)]);function m(e){l.disabled||d("click",e)}return(e,h)=>(_(),$("a",{class:D(a(u)),href:e.disabled||!e.href?void 0:e.href,onClick:m},[e.icon?(_(),v(a(Y),{key:0},{default:t(()=>[(_(),v(K(e.icon)))]),_:1})):b("v-if",!0),e.$slots.default?(_(),$("span",{key:1,class:D(a(n).e("inner"))},[A(e.$slots,"default")],2)):b("v-if",!0),e.$slots.icon?A(e.$slots,"icon",{key:2}):b("v-if",!0)],10,le))}});var ie=Z(se,[["__file","/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue"]]);const re=ee(ie);const ce=r=>new Promise(d=>setTimeout(d,r)),Te=w({__name:"downloadDialog",setup(r){const d=O(),{clientConfig:l,dlinkList:n,downloadDialogVisible:u,selectDownloadFiles:m,aria2ConfigForm:e,aria2ConfigDialogVisible:h}=x(d),C=async(s,i)=>{let f;try{f=await oe.post(`${e.value.host}:${e.value.port}/jsonrpc`,{jsonrpc:"2.0",id:J(),method:"aria2.addUri",params:[`token:${e.value.secret}`,[s],{out:i,header:[`User-Agent: ${l.value.userAgent}`]}]})}catch{g.error("发送失败，请检查控制台输出，自行谷歌搜索或拉起issue"),f="failed"}f!=="failed"&&g.success(`已把${i}任务发送给下载器`)},V=s=>m.value=s,T=()=>h.value=!0,B=async()=>{g.error("请确保最大同时下载文件数在5及以下,否则可能出现下载失败!"),await ce(3e3),g.success("开始下载"),m.value.forEach(s=>C(s.dlink,s.server_filename))};return(s,i)=>{const f=M,E=re,k=I,P=j,y=z,U=R,F=N;return _(),v(F,{modelValue:a(u),"onUpdate:modelValue":i[1]||(i[1]=c=>H(u)?u.value=c:null),title:"解析任务列表",width:"80%"},{default:t(()=>[o(P,null,{default:t(()=>[o(f,{class:"mx-1"},{default:t(()=>[p("当前的UA :")]),_:1}),o(E,{type:"danger",onClick:i[0]||(i[0]=c=>a(S)(a(l).userAgent,"已复制UA"))},{default:t(()=>[p(G(a(l).userAgent),1)]),_:1}),o(k,{type:"primary",disabled:a(m).length<=0,onClick:B},{default:t(()=>[p(" 批量下载 ")]),_:1},8,["disabled"]),o(k,{type:"primary",onClick:T},{default:t(()=>[p("下载配置")]),_:1})]),_:1}),o(U,{border:"","show-overflow-tooltip":"",class:"table",data:a(n),onSelectionChange:V},{default:t(()=>[o(y,{type:"selection",width:"40"}),o(y,{prop:"server_filename",label:"文件名"}),o(y,{prop:"dlink",label:"下载链接"}),o(y,{label:"操作",width:"190"},{default:t(c=>[o(k,{type:"primary",size:"small",onClick:L=>a(S)(c.row.dlink,"已将链接复制到粘贴板内")},{default:t(()=>[p(" 复制链接 ")]),_:2},1032,["onClick"]),o(k,{type:"primary",size:"small",onClick:L=>C(c.row.dlink,c.row.server_filename)},{default:t(()=>[p(" 发送Aria2 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])}}});export{Te as default};
