import{C as te,I as q,U as A,t as me,d as Q}from"./base-e8db4a9d.js";import{v as pe}from"./el-loading-e18e9ff6.js";import{E as ce,a as fe}from"./el-form-item-77bf1366.js";import{E as ge}from"./el-button-21ff238e.js";import{E as re}from"./el-input-e0bc9846.js";import{E as be}from"./el-switch-2fdfdbee.js";import{b as ve,c as Ve,e as we}from"./admin-f9a97a86.js";import{a7 as X,a as j,r as H,N as Ne,g as x,G as Ee,o as le,J as _e,e as I,c as $,P as J,u as n,n as Y,af as D,b as o,w as p,R as F,i as Z,a6 as O,L as ye,d as he,m as Ie,ag as Se,q as Ce,B as Pe}from"./index-607dfe2f.js";import{b as ke,y as xe,n as E,C as Ae,u as Fe,l as R,D as Ue,F as Te,f as ee,G as Me,p as Be,_ as ze,w as De,E as W}from"./request-70b65b72.js";import{i as U}from"./isNil-c75b1b34.js";import{a as Oe,u as Re,b as qe}from"./use-form-item-1a794399.js";import"./_initCloneObject-b85b73ba.js";import"./index-53bf12df.js";import"./validator-4fa462e3.js";const Le=100,Ge=600,ne={beforeMount(i,_){const t=_.value,{interval:a=Le,delay:C=Ge}=X(t)?{}:t;let b,V;const d=()=>X(t)?t():t.handler(),N=()=>{V&&(clearTimeout(V),V=void 0),b&&(clearInterval(b),b=void 0)};i.addEventListener("mousedown",v=>{v.button===0&&(N(),d(),document.addEventListener("mouseup",()=>N(),{once:!0}),V=setTimeout(()=>{b=setInterval(()=>{d()},a)},C))})}},Ke=ke({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:xe,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:i=>i===null||E(i)||["min","max"].includes(i),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:i=>i>=0&&i===Number.parseInt(`${i}`,10)},validateEvent:{type:Boolean,default:!0}}),$e={[te]:(i,_)=>_!==i,blur:i=>i instanceof FocusEvent,focus:i=>i instanceof FocusEvent,[q]:i=>E(i)||U(i),[A]:i=>E(i)||U(i)},Ye=["aria-label","onKeydown"],We=["aria-label","onKeydown"],He=j({name:"ElInputNumber"}),Je=j({...He,props:Ke,emits:$e,setup(i,{expose:_,emit:t}){const a=i,{t:C}=Ae(),b=Fe("input-number"),V=H(),d=Ne({currentValue:a.modelValue,userInput:null}),{formItem:N}=Oe(),v=x(()=>E(a.modelValue)&&a.modelValue<=a.min),l=x(()=>E(a.modelValue)&&a.modelValue>=a.max),c=x(()=>{const e=T(a.step);return R(a.precision)?Math.max(T(a.modelValue),e):(e>a.precision,a.precision)}),m=x(()=>a.controls&&a.controlsPosition==="right"),S=Re(),h=qe(),P=x(()=>{if(d.userInput!==null)return d.userInput;let e=d.currentValue;if(U(e))return"";if(E(e)){if(Number.isNaN(e))return"";R(a.precision)||(e=e.toFixed(a.precision))}return e}),k=(e,r)=>{if(R(r)&&(r=c.value),r===0)return Math.round(e);let s=String(e);const f=s.indexOf(".");if(f===-1||!s.replace(".","").split("")[f+r])return e;const B=s.length;return s.charAt(B-1)==="5"&&(s=`${s.slice(0,Math.max(0,B-1))}6`),Number.parseFloat(Number(s).toFixed(r))},T=e=>{if(U(e))return 0;const r=e.toString(),s=r.indexOf(".");let f=0;return s!==-1&&(f=r.length-s-1),f},u=(e,r=1)=>E(e)?k(e+a.step*r):d.currentValue,L=()=>{if(a.readonly||h.value||l.value)return;const e=Number(P.value)||0,r=u(e);M(r),t(q,d.currentValue)},G=()=>{if(a.readonly||h.value||v.value)return;const e=Number(P.value)||0,r=u(e,-1);M(r),t(q,d.currentValue)},K=(e,r)=>{const{max:s,min:f,step:g,precision:y,stepStrictly:B,valueOnClear:z}=a;s<f&&me("InputNumber","min should not be greater than max.");let w=Number(e);if(U(e)||Number.isNaN(w))return null;if(e===""){if(z===null)return null;w=ye(z)?{min:f,max:s}[z]:z}return B&&(w=k(Math.round(w/g)*g,y)),R(y)||(w=k(w,y)),(w>s||w<f)&&(w=w>s?s:f,r&&t(A,w)),w},M=(e,r=!0)=>{var s;const f=d.currentValue,g=K(e);if(!r){t(A,g);return}f!==g&&(d.userInput=null,t(A,g),t(te,g,f),a.validateEvent&&((s=N==null?void 0:N.validate)==null||s.call(N,"change").catch(y=>Q())),d.currentValue=g)},oe=e=>{d.userInput=e;const r=e===""?null:Number(e);t(q,r),M(r,!1)},ae=e=>{const r=e!==""?Number(e):"";(E(r)&&!Number.isNaN(r)||e==="")&&M(r),d.userInput=null},ue=()=>{var e,r;(r=(e=V.value)==null?void 0:e.focus)==null||r.call(e)},se=()=>{var e,r;(r=(e=V.value)==null?void 0:e.blur)==null||r.call(e)},ie=e=>{t("focus",e)},de=e=>{var r;t("blur",e),a.validateEvent&&((r=N==null?void 0:N.validate)==null||r.call(N,"blur").catch(s=>Q()))};return Ee(()=>a.modelValue,e=>{const r=K(d.userInput),s=K(e,!0);!E(r)&&(!r||r!==s)&&(d.currentValue=s,d.userInput=null)},{immediate:!0}),le(()=>{var e;const{min:r,max:s,modelValue:f}=a,g=(e=V.value)==null?void 0:e.input;if(g.setAttribute("role","spinbutton"),Number.isFinite(s)?g.setAttribute("aria-valuemax",String(s)):g.removeAttribute("aria-valuemax"),Number.isFinite(r)?g.setAttribute("aria-valuemin",String(r)):g.removeAttribute("aria-valuemin"),g.setAttribute("aria-valuenow",d.currentValue||d.currentValue===0?String(d.currentValue):""),g.setAttribute("aria-disabled",String(h.value)),!E(f)&&f!=null){let y=Number(f);Number.isNaN(y)&&(y=null),t(A,y)}}),_e(()=>{var e,r;const s=(e=V.value)==null?void 0:e.input;s==null||s.setAttribute("aria-valuenow",`${(r=d.currentValue)!=null?r:""}`)}),_({focus:ue,blur:se}),(e,r)=>(I(),$("div",{class:Y([n(b).b(),n(b).m(n(S)),n(b).is("disabled",n(h)),n(b).is("without-controls",!e.controls),n(b).is("controls-right",n(m))]),onDragstart:r[1]||(r[1]=O(()=>{},["prevent"]))},[e.controls?J((I(),$("span",{key:0,role:"button","aria-label":n(C)("el.inputNumber.decrease"),class:Y([n(b).e("decrease"),n(b).is("disabled",n(v))]),onKeydown:D(G,["enter"])},[o(n(ee),null,{default:p(()=>[n(m)?(I(),F(n(Ue),{key:0})):(I(),F(n(Te),{key:1}))]),_:1})],42,Ye)),[[n(ne),G]]):Z("v-if",!0),e.controls?J((I(),$("span",{key:1,role:"button","aria-label":n(C)("el.inputNumber.increase"),class:Y([n(b).e("increase"),n(b).is("disabled",n(l))]),onKeydown:D(L,["enter"])},[o(n(ee),null,{default:p(()=>[n(m)?(I(),F(n(Me),{key:0})):(I(),F(n(Be),{key:1}))]),_:1})],42,We)),[[n(ne),L]]):Z("v-if",!0),o(n(re),{id:e.id,ref_key:"input",ref:V,type:"number",step:e.step,"model-value":n(P),placeholder:e.placeholder,readonly:e.readonly,disabled:n(h),size:n(S),max:e.max,min:e.min,name:e.name,label:e.label,"validate-event":!1,onWheel:r[0]||(r[0]=O(()=>{},["prevent"])),onKeydown:[D(O(L,["prevent"]),["up"]),D(O(G,["prevent"]),["down"])],onBlur:de,onFocus:ie,onInput:oe,onChange:ae},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var je=ze(Je,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]);const Qe=De(je);const Xe=he("ChangeConfig",()=>{const i=H({version:"",frontEndVersion:"",userAgent:"",sleep:1,maxOnce:20,announceSwitch:!1,announce:"",cookie:"",ssl:!1,prefix:"/admin",debug:!1,password:"",passwordSwitch:!1,getPending:!1,changePending:!1}),_=H(null);return{changeConfigForm:i,changeConfigFormRef:_}}),fn=j({__name:"ChangeConfig",setup(i){const _=Xe(),{changeConfigForm:t,changeConfigFormRef:a}=Ie(_),V={userAgent:[{required:!0,message:"请输入User_Agent",trigger:"blur"}],announce:[{validator:(v,l,c)=>{t.value.passwordSwitch&&l===""&&c(new Error("请输入公告内容")),c()},trigger:"blur"}],announceSwitch:[{required:!0,message:"请确认开关状态",trigger:"blur"}],debug:[{required:!0,message:"请确认开关状态",trigger:"blur"}],ssl:[{required:!0,message:"请确认开关状态",trigger:"blur"}],prefix:[{required:!0,message:"请输入后台接口后缀",trigger:"blur"}],cookie:[{required:!0,message:"请输入获取列表时的 Cookie",trigger:"blur"}],maxOnce:[{required:!0,message:"请输入批量解析时单次最大解析数量",trigger:"blur"}],sleep:[{required:!0,message:"请输入批量解析时休眠时间(秒)",trigger:"blur"}],password:[{validator:(v,l,c)=>{t.value.passwordSwitch&&l===""&&c(new Error("请输入密码")),c()},trigger:"blur"}],passwordSwitch:[{required:!0,message:"请确认开关状态",trigger:"blur"}]};le(async()=>await d());const d=async()=>{t.value.getPending=!0;const v=await ve()??"failed";t.value.getPending=!1,v.toString()!=="failed"&&(t.value={...t.value,...v.data,frontEndVersion:await Se()})},N=async v=>{if(v&&await v.validate(()=>{})){t.value.changePending=!0;const l=await Ve({cookie:t.value.cookie,check:!0})??"failed";if(l.toString()==="failed")return;if(t.value.changePending=!1,l.message!=="cookie校验成功"){W.error("请不要使用包含账户的cookie,直接退出登陆获取一个新cookie");return}W.success("cookie校验成功,不包含账户");const c=await we({...t.value})??"failed";if(t.value.changePending=!1,c.toString()==="failed")return;W.success("修改成功"),Pe(t.value.prefix),await d()}};return(v,l)=>{const c=re,m=ce,S=be,h=Qe,P=ge,k=fe,T=pe;return J((I(),F(k,{ref_key:"changeConfigFormRef",ref:a,model:n(t),rules:V,"label-width":"auto"},{default:p(()=>[o(m,{label:"后端版本号",prop:"version"},{default:p(()=>[o(c,{disabled:"",modelValue:n(t).version,"onUpdate:modelValue":l[0]||(l[0]=u=>n(t).version=u)},null,8,["modelValue"])]),_:1}),o(m,{label:"前端版本号",prop:"frontEndVersion"},{default:p(()=>[o(c,{disabled:"",modelValue:n(t).frontEndVersion,"onUpdate:modelValue":l[1]||(l[1]=u=>n(t).frontEndVersion=u)},null,8,["modelValue"])]),_:1}),o(m,{label:"DEBUG模式开关",prop:"debug"},{default:p(()=>[o(S,{modelValue:n(t).debug,"onUpdate:modelValue":l[2]||(l[2]=u=>n(t).debug=u),size:"large"},null,8,["modelValue"])]),_:1}),o(m,{label:"强制SSL模式开关",prop:"ssl"},{default:p(()=>[o(S,{modelValue:n(t).ssl,"onUpdate:modelValue":l[3]||(l[3]=u=>n(t).ssl=u),size:"large"},null,8,["modelValue"])]),_:1}),o(m,{label:"公告开关",prop:"announceSwitch"},{default:p(()=>[o(S,{modelValue:n(t).announceSwitch,"onUpdate:modelValue":l[4]||(l[4]=u=>n(t).announceSwitch=u),size:"large"},null,8,["modelValue"])]),_:1}),o(m,{label:"公告内容",prop:"announce"},{default:p(()=>[o(c,{type:"textarea",modelValue:n(t).announce,"onUpdate:modelValue":l[5]||(l[5]=u=>n(t).announce=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),o(m,{label:"后台接口前缀",prop:"prefix"},{default:p(()=>[o(c,{modelValue:n(t).prefix,"onUpdate:modelValue":l[6]||(l[6]=u=>n(t).prefix=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),o(m,{label:"下载使用的 User_Agent",prop:"userAgent"},{default:p(()=>[o(c,{modelValue:n(t).userAgent,"onUpdate:modelValue":l[7]||(l[7]=u=>n(t).userAgent=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),o(m,{label:"批量解析时休眠时间(秒)",prop:"sleep"},{default:p(()=>[o(h,{modelValue:n(t).sleep,"onUpdate:modelValue":l[8]||(l[8]=u=>n(t).sleep=u)},null,8,["modelValue"])]),_:1}),o(m,{label:"批量解析时单次最大解析数量",prop:"maxOnce"},{default:p(()=>[o(h,{modelValue:n(t).maxOnce,"onUpdate:modelValue":l[9]||(l[9]=u=>n(t).maxOnce=u)},null,8,["modelValue"])]),_:1}),o(m,{label:"获取列表时的 Cookie",prop:"cookie"},{default:p(()=>[o(c,{type:"textarea",modelValue:n(t).cookie,"onUpdate:modelValue":l[10]||(l[10]=u=>n(t).cookie=u),modelModifiers:{trim:!0},rows:"5"},null,8,["modelValue"])]),_:1}),o(m,{label:"密码开关",prop:"passwordSwitch"},{default:p(()=>[o(S,{modelValue:n(t).passwordSwitch,"onUpdate:modelValue":l[11]||(l[11]=u=>n(t).passwordSwitch=u),size:"large"},null,8,["modelValue"])]),_:1}),o(m,{label:"密码",prop:"password"},{default:p(()=>[o(c,{modelValue:n(t).password,"onUpdate:modelValue":l[12]||(l[12]=u=>n(t).password=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),o(m,{label:" "},{default:p(()=>[o(P,{type:"primary",onClick:l[13]||(l[13]=u=>N(n(a))),loading:n(t).changePending},{default:p(()=>[Ce(" 保存 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])),[[T,n(t).getPending]])}}});export{fn as default};
